library(tm)
library(SnowballC)
library(topicmodels)
library(searcher)
library(magick)
setwd("/Users/rishavjain")
filenames <- list.files(getwd(),pattern="r.txt")
files <- lapply(filenames,readLines)
articles.corpus <- Corpus(VectorSource(files))
articles.corpus <- tm_map(articles.corpus, tolower)
articles.corpus <- tm_map(articles.corpus, removePunctuation)
articles.corpus <- tm_map(articles.corpus, removeNumbers)
toSpace <- content_transformer(function(x, pattern) {return (gsub(pattern, '', x))})
articles.corpus <- tm_map(articles.corpus, toSpace, '-')
articles.corpus <- tm_map(articles.corpus, toSpace, ':')
articles.corpus <- tm_map(articles.corpus, toSpace, '“')
articles.corpus <- tm_map(articles.corpus, toSpace, '”')
articles.corpus <- tm_map(articles.corpus, toSpace, "'")
articles.corpus <- tm_map(articles.corpus, toSpace, "—")
stopword <- c(stopwords('english') )
articles.corpus <- tm_map(articles.corpus, removeWords, stopword)
articles.corpus <- tm_map(articles.corpus, stemDocument)
articles.corpus <- tm_map(articles.corpus, stripWhitespace)
articleDtm <- DocumentTermMatrix(articles.corpus, control = list(minWordLength = 3))
articleDtm2 <- removeSparseTerms(articleDtm, sparse=0.98)
k = 10;
SEED = 1;
article.lda <- LDA(articleDtm2, k, method="Gibbs", control=list(seed = SEED))
lda.topics <- as.matrix(topics(article.lda))
lda.terms <- terms(article.lda)
lda.terms

Index<- as.integer(strsplit(readline("enter the topic numbers (space-separated list)(select any 4) "), " ")[[1]])
query1<-paste(lda.terms[Index[1]],"images",sep=" ")
query2<-paste(lda.terms[Index[2]],"images",sep=" ")
query3<-paste(lda.terms[Index[3]],"images",sep=" ")
query4<-paste(lda.terms[Index[4]],"images",sep=" ")

search_google(query1,rlang=FALSE)
search_google(query2,rlang=FALSE)
search_google(query3,rlang=FALSE)
search_google(query4,rlang=FALSE)

image_1 <- image_read('/Users/rishavjain/Newfiles/download1.png')
image_2 <- image_read('/Users/rishavjain/Newfiles/download.png')
image_3 <- image_read('/Users/rishavjain/Newfiles/download.png')
image_4 <- image_read('/Users/rishavjain/Newfiles/download.png')

plot(as.raster(image_1))
plot(as.raster(image_2))
plot(as.raster(image_3))
plot(as.raster(image_4))


#TEMPLATE1
template <- image_read('/Users/rishavjain/Newfiles/download.png')
plot(template)
image_info(template)
#use locator function to locate coordinates of template
rasterImage(image_1,147.0367,464.0173, 480.7444, 859.3326)
rasterImage(image_2,580.8567, 461.4503,911.9974 , 861.8996)
rasterImage(image_3,1012.110,456.3164, 1340.683, 861.8996)
rasterImage(image_4,1443.363, 458.8834, 1771.936, 859.3326)
text(x=316,y=258,labels = lda.terms[1],col = 0,cex = 1.5)
text(x=750.2776,y=271.4937,labels = lda.terms[2],col = 0,cex = 1.5)
text(x=1181.531,y=266.3597,labels = lda.terms[4],col = 0,cex = 1.5)
text(x=1605.083,y=271.4937,labels = lda.terms[5],col = 0,cex = 1.5)
text(x=960.7701,y=956.8779,labels = "TOPIC MODELS",col = 7,cex = 2.5)

#TEMPLATE2
template <- image_read('/Users/rishavjain/Newfiles/download.png')
plot(template)
image_info(template)
rasterImage(image_1,62.4660,276.1725, 208.9232, 381.6486)
rasterImage(image_2,274.7617, 274.8289,423.9062 , 376.9458)
rasterImage(image_3,60.79418,67.23593, 210.26681, 168.68104)
rasterImage(image_4,274.7617, 67.23593, 423.9062, 172.04014)
text(x=135.6946,y=455.549,labels = lda.terms[1],col = 0,cex = 1.5)
text(x=352.0212,y=455.549,labels = lda.terms[2],col = 0,cex = 1.5)
text(x=139.0537,y=35.66030,labels = lda.terms[4],col = 0,cex = 1.5)
text(x=347.9903,y=35.66030,labels = lda.terms[5],col = 0,cex = 1.5)

#TEMPLATE3
template <- image_read('/Users/rishavjain/Newfiles/download.png')
plot(template)
image_info(template)
rasterImage(image_1,41.53441,497.3530, 401.83978, 720.0614)
rasterImage(image_2,652.9187, 493.0974,1018.8982 , 721.4800)
rasterImage(image_3,59.97524,39.16942, 427.37323, 251.94818)
rasterImage(image_4,624.5482, 42.00647, 1016.0611, 254.78523)
text(x=221.6871,y=773.9654,labels = lda.terms[1],col = 0,cex = 1.5)
text(x=221.6871,y=308.6892,labels = lda.terms[4],col = 0,cex = 1.5)
text(x=828.8158,y=773.9654,labels = lda.terms[2],col = 0,cex = 1.5)
text(x=828.8158,y=308.6892,labels = lda.terms[5],col = 0,cex = 1.5)


#TEMPLATE4
template <- image_read('/Users/rishavjain/Newfiles/download.png')
plot(template)
image_info(template)
rasterImage(image_1,16.59331,17.47066, 326.79678, 265.63343)
rasterImage(image_2,377.6701, 17.47066,684.1512 , 265.63343)
rasterImage(image_3,16.59331,385.9924, 326.79678, 639.1184)
rasterImage(image_4,377.6701, 385.9924, 684.1512, 639.1184)
text(x=167.9726,y=307.8211,labels = lda.terms[1],col = 1,cex = 1.5)
text(x=532.7719,y=307.8211,labels = lda.terms[2],col = 1,cex = 1.5)
text(x=167.9726,y=680.0653,labels = lda.terms[4],col = 1,cex = 1.5)
text(x=532.7719,y=680.0653,labels = lda.terms[5],col = 1,cex = 1.5)


dev.off()
